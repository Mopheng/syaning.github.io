compile(A)
    compileNodes([A])
        collectiveDirectives(A)
        applyDirectivesToNode(directives, A)
        compileNodes([B, C, D])
            collectiveDirectives(B)
            applyDirectivesToNode(directives, B)
            collectiveDirectives(C)
            applyDirectivesToNode(directives, C)
            compileNodes([E, F])
                collectiveDirectives(E)
                applyDirectivesToNode(directives, E)
                collectiveDirectives(F)
                applyDirectivesToNode(directives, F)
                compileNodes([G])
                    collectiveDirectives(G)
                    applyDirectivesToNode(directives, G)
            collectiveDirectives(D)
            applyDirectivesToNode(directives, D)